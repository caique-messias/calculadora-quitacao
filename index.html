<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Calculadora de Quitação de Parcelas (Price/SAC) — Economize Juros</title>
<meta name="description" content="Descubra quanto de juros você economiza ao quitar/antecipar parcelas de financiamento. Suporta Price (parcelas iguais) e SAC (parcelas decrescentes).">
<meta property="og:title" content="Calculadora de Quitação — Economize Juros">
<meta property="og:description" content="Simule sua economia ao quitar tudo agora ou antecipar a última parcela.">
<meta property="og:type" content="website">
<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ctext y='52' x='6' font-size='56'%3E%24%3C/text%3E%3C/svg%3E">
<style>
  :root{
    --bg:#0b1220;--card:#0f172a;--txt:#e5e7eb;--muted:#9ca3af;
    --ok:#22c55e;--warn:#f59e0b;--err:#ef4444;--stroke:#1f2937;--field:#0b1220;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--txt);font:16px/1.5 system-ui,Segoe UI,Roboto,Arial}
  .wrap{max-width:920px;margin:28px auto;padding:0 16px}
  .card{background:var(--card);border-radius:18px;padding:18px 16px;box-shadow:0 8px 30px rgba(0,0,0,.35)}
  h1{margin:0 0 8px;font-size:22px}
  p.lead{margin:0 0 6px;color:var(--muted)}
  .row{display:grid;gap:12px}
  @media(min-width:720px){.row{grid-template-columns:1fr 1fr}}
  label{display:flex;align-items:center;gap:6px;margin:10px 0 6px;color:var(--muted)}
  .hint{font-size:12px;color:var(--muted)}
  input,select,button{
    width:100%;padding:12px 12px;border-radius:12px;border:1px solid var(--stroke);
    background:var(--field);color:var(--txt);outline:none
  }
  input:focus,select:focus{border-color:#334155;box-shadow:0 0 0 3px rgba(51,65,85,.35)}
  button{cursor:pointer}
  .btn{background:#1f2937;border-color:#334155}
  .btn:hover{filter:brightness(1.08)}
  .result{margin-top:16px;padding:14px;border-radius:12px;background:#0b1220;border:1px solid var(--stroke)}
  .ok{color:var(--ok)} .warn{color:var(--warn)} .err{color:var(--err)} .muted{color:var(--muted)}
  .inline-help{display:inline-block;border:1px solid var(--stroke);border-radius:8px;padding:6px 8px;margin-left:auto;font-size:12px;color:var(--muted)}
  .kv{display:grid;grid-template-columns:1fr auto;gap:8px;align-items:center}
  .foot{margin-top:18px;font-size:12px;color:var(--muted)}
  .badge{font-size:12px;padding:2px 8px;border-radius:999px;border:1px solid var(--stroke);color:var(--muted)}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <div style="display:flex;gap:8px;align-items:center;justify-content:space-between;flex-wrap:wrap">
      <div>
        <h1>Calculadora de Quitação / Antecipação</h1>
        <p class="lead">Veja quanto de <b>juros</b> você economiza ao <b>quitar agora</b> ou antecipar a <b>última parcela</b>.</p>
      </div>
      <span class="inline-help">Dica: se as parcelas são iguais → <b>Price</b>. Se caem todo mês → <b>SAC</b>.</span>
    </div>

    <fieldset class="row" style="margin-top:8px">
      <div>
        <label for="tipo">Tipo do financiamento</label>
        <select id="tipo">
          <option value="price" selected>Price (parcelas iguais)</option>
          <option value="sac">SAC (parcelas que caem)</option>
        </select>
      </div>
      <div>
        <label for="parcela">Valor da parcela atual (R$)</label>
        <input id="parcela" inputmode="decimal" placeholder="Ex.: 1.200,00" />
        <div class="hint">No app/boleto aparece como “valor da parcela”.</div>
      </div>
    </fieldset>

    <fieldset class="row">
      <div>
        <label for="n">Parcelas restantes (N)</label>
        <input id="n" inputmode="numeric" placeholder="Ex.: 24" />
      </div>
      <div>
        <label for="saldo">Saldo devedor (opcional)</label>
        <input id="saldo" inputmode="decimal" placeholder="Ex.: 22.500,00" />
        <div class="hint">Se informar, calculamos mesmo sem a taxa.</div>
      </div>
    </fieldset>

    <fieldset class="row">
      <div>
        <label for="taxaMes">Taxa ao mês % (opcional)</label>
        <input id="taxaMes" inputmode="decimal" placeholder="Ex.: 1,49" />
      </div>
      <div>
        <label for="cetAno">ou CET ao ano % (opcional)</label>
        <input id="cetAno" inputmode="decimal" placeholder="Ex.: 22,5" />
        <div class="hint">Converteremos para mês automaticamente.</div>
      </div>
    </fieldset>

    <fieldset class="row">
      <div>
        <label for="multa">Multa de quitação % (opcional)</label>
        <input id="multa" inputmode="decimal" placeholder="Ex.: 2" />
        <div class="hint">Alguns contratos cobram até 2% sobre o saldo.</div>
      </div>
      <div>
        <label for="modo">O que antecipar?</label>
        <select id="modo">
          <option value="tudo" selected>Quitar tudo agora</option>
          <option value="ultima">Antecipar só a última parcela (Price)</option>
        </select>
      </div>
    </fieldset>

    <div style="margin-top:10px">
      <button id="btn" class="btn">Calcular</button>
    </div>

    <div id="out" class="result" style="display:none"></div>

    <div class="foot">
      ⚠️ <b>Aviso:</b> Resultado educativo/estimado. Regras específicas do seu contrato podem alterar valores. Confirme com sua instituição antes de decidir.
    </div>
  </div>
</div>

<script>
  // ===== Helpers de número/máscara =====
  const brToNumber = (s) => {
    if(!s) return NaN;
    return Number(String(s).replace(/\./g,'').replace(',','.').replace(/[^\d.-]/g,''));
  };
  const fmtBRL = (v) => v.toLocaleString('pt-BR',{style:'currency',currency:'BRL'});
  const fmtPct  = (v) => (v*100).toLocaleString('pt-BR',{maximumFractionDigits:3}) + '%';

  // máscara leve para R$ e %
  const maskCurrency = (el)=> {
    el.addEventListener('blur', ()=> {
      const n = brToNumber(el.value);
      if(!isNaN(n) && el.value.trim()!=='') el.value = n.toLocaleString('pt-BR',{minimumFractionDigits:2,maximumFractionDigits:2});
    });
  };
  const maskPercent = (el)=> {
    el.addEventListener('blur', ()=> {
      const n = brToNumber(el.value);
      if(!isNaN(n) && el.value.trim()!=='') el.value = n.toLocaleString('pt-BR',{maximumFractionDigits:3});
    });
  };

  ['parcela','saldo'].forEach(id=>maskCurrency(document.getElementById(id)));
  ['taxaMes','cetAno','multa'].forEach(id=>maskPercent(document.getElementById(id)));

  // ===== Math =====
  const anualParaMes = a => Math.pow(1+a,1/12)-1;         // a em fração (ex.: 0.225)
  const pvPrice = (A,i,N) => A*(1 - Math.pow(1+i,-N))/i;  // presente de anuidade

  function economiaPrice(A,N,PV,i){
    let usadoPV = PV;
    if(!(usadoPV>0)){
      if(!(i>0)) return {erro:"Para <b>Price</b>, informe <b>Saldo</b> ou <b>Taxa</b>."};
      usadoPV = pvPrice(A,i,N);
    }
    const economiaBruta = (A*N) - usadoPV; // total futuro - PV
    return {economiaBruta, usadoPV, i};
  }

  function ultimaParcelaPrice(A,N,i){
    if(!(i>0)) return {erro:"Para antecipar só a última parcela, informe a <b>Taxa</b> (ou CET)."};
    const hoje = A/Math.pow(1+i,N);
    return {desconto: A - hoje, pagarHoje: hoje};
  }

  // SAC: juros poupados ≈ i * PV * (N+1)/2
  // Se i não informado, estimar por: parcelaAtual = PV/N + i*PV  ⇒ i ≈ parcela/PV - 1/N
  function economiaSAC(parcela, N, PV, i){
    if(!(PV>0)) return {erro:"Para <b>SAC</b>, informe o <b>Saldo</b>."};
    let taxa = i;
    if(!(taxa>0)){
      if(!(parcela>0)) return {erro:"Para <b>SAC</b>, informe <b>Taxa</b> ou a <b>parcela atual</b>."};
      taxa = (parcela/PV) - (1/N);
      if(!(taxa>0)) return {erro:"Dados insuficientes: revise parcela/saldo/N."};
    }
    const economiaBruta = taxa * PV * (N+1) / 2;
    return {economiaBruta, i:taxa};
  }

  document.getElementById('btn').onclick = () => {
    const tipo   = document.getElementById('tipo').value;
    const A      = brToNumber(document.getElementById('parcela').value);
    const N      = parseInt((document.getElementById('n').value||'0').trim(),10);
    const PV     = brToNumber(document.getElementById('saldo').value);
    const iMes   = brToNumber(document.getElementById('taxaMes').value)/100;
    const iAno   = brToNumber(document.getElementById('cetAno').value)/100;
    const multaPct = brToNumber(document.getElementById('multa').value)/100 || 0;
    const modo   = document.getElementById('modo').value;

    let i = NaN;
    if(iMes>0) i = iMes;
    else if(iAno>0) i = anualParaMes(iAno);

    const out = document.getElementById('out');
    out.style.display = 'block';

    // validações mínimas
    if(!(N>0)){ out.innerHTML = "<span class='err'>Informe <b>Parcelas restantes (N)</b>.</span>"; return; }
    if(tipo==='price' && !(A>0)){ out.innerHTML = "<span class='err'>Informe o <b>valor da parcela</b>.</span>"; return; }
    if(modo==='ultima' && tipo==='sac'){ out.innerHTML = "Antecipar só a última parcela aqui é suportado para <b>Price</b>."; return; }

    // lógica
    if(tipo==='price'){
      if(modo==='ultima'){
        const r = ultimaParcelaPrice(A,N,i);
        if(r.erro){ out.innerHTML = r.erro; return; }
        let pagar = r.pagarHoje;
        let multa = 0;
        if(PV>0 && multaPct>0){ multa = PV*multaPct; pagar += multa; }
        const econ = r.desconto - multa;
        out.innerHTML = `
          <div class="kv"><div><b>Antecipar a última parcela (Price)</b></div><span class="badge">Parcela nº ${N}</span></div>
          <div>Parcela futura: <b>${fmtBRL(A)}</b></div>
          <div>Pagar hoje (PV da última): <b>${fmtBRL(r.pagarHoje)}</b></div>
          ${multa?`<div>Multa sobre saldo: <b>${fmtBRL(multa)}</b></div>`:''}
          <div class="${multa?'warn':'ok'}">Economia estimada: <b>${fmtBRL(Math.max(0,econ))}</b></div>
          <div class="muted">Taxa usada: ${fmtPct(i)} ao mês</div>
        `;
        return;
      } else {
        const r = economiaPrice(A,N,PV,i);
        if(r.erro){ out.innerHTML = r.erro; return; }
        const multa = (r.usadoPV||0)*multaPct;
        const econLiquida = r.economiaBruta - multa;
        out.innerHTML = `
          <div class="kv"><div><b>Quitar tudo agora (Price)</b></div><span class="badge">${r.i>0?('Taxa: '+fmtPct(r.i)+' a.m.'):'Taxa estimada/—'}</span></div>
          <div>Somatório de parcelas futuras: <b>${fmtBRL(A*N)}</b></div>
          <div>Quitar hoje (aprox.): <b>${fmtBRL(r.usadoPV + multa)}</b> ${multa?`<span class="muted">(inclui multa)</span>`:''}</div>
          <div class="ok">Economia de juros (bruta): <b>${fmtBRL(Math.max(0,r.economiaBruta))}</b></div>
          ${multa?`<div>Multa: <b>${fmtBRL(multa)}</b></div>`:''}
          <div class="${multa?'warn':'ok'}">Economia <b>líquida</b>: <b>${fmtBRL(Math.max(0,econLiquida))}</b></div>
          <div class="muted">Saldo considerado: ${fmtBRL(r.usadoPV||0)}</div>
        `;
        return;
      }
    }

    if(tipo==='sac'){
      const r = economiaSAC(A,N,PV,i);
      if(r.erro){ out.innerHTML = r.erro; return; }
      const multa = (PV||0)*multaPct;
      const econLiquida = r.economiaBruta - multa;
      out.innerHTML = `
        <div class="kv"><div><b>Quitar tudo agora (SAC)</b></div><span class="badge">Taxa usada/estimada: ${fmtPct(r.i)} a.m.</span></div>
        <div>Juros que seriam pagos (estimativa): <b>${fmtBRL(Math.max(0,r.economiaBruta))}</b></div>
        ${multa?`<div>Multa: <b>${fmtBRL(multa)}</b></div>`:''}
        <div class="${multa?'warn':'ok'}">Economia <b>líquida</b>: <b>${fmtBRL(Math.max(0,econLiquida))}</b></div>
        <div class="muted">Saldo informado: ${fmtBRL(PV||0)} • Parcelas restantes: ${N}</div>
      `;
      return;
    }

    out.innerHTML = "Revise os dados.";
  };
</script>
</body>
</html>
